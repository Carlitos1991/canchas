{% extends "base.html" %}
{% load static %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
    <div class="content-container">

        <div class="dashboard-header">
            <div>
                <h1 class="dashboard-title">Mi Perfil</h1>
                <p class="dashboard-subtitle">Gestiona tu información personal y cuenta.</p>
            </div>
        </div>

        {% if persona %}
            <div class="profile-wrapper">

                <!-- COLUMNA IZQUIERDA: Tarjeta Principal -->
                <div class="profile-sidebar-card">
                    {% if persona.foto %}
                        <img src="{{ persona.foto.url }}" alt="Avatar" class="profile-avatar-large">
                    {% else %}
                        <img src="{% static 'media/default_avatar.png' %}" alt="Avatar" class="profile-avatar-large">
                        <!-- Asegúrate de tener una imagen default o usar un placeholder de internet -->
                    {% endif %}

                    <div class="profile-name">{{ persona.nombre }} {{ persona.apellido }}</div>
                    <div class="profile-role">{{ persona.get_rol_display }}</div>

                    <div style="margin-top: 1.5rem; border-top: 1px solid var(--border-light); padding-top: 1.5rem;">
                        <div class="detail-label">Estado de cuenta</div>
                        <div style="margin-top: 5px;">
                            {% if persona.estado %}
                                <span class="status-indicator status-active"><i class="fa-solid fa-circle-check"></i> Activo</span>
                            {% else %}
                                <span class="status-indicator status-inactive"><i class="fa-solid fa-circle-xmark"></i> Inactivo</span>
                            {% endif %}
                        </div>
                    </div>

                    <a href="{% url 'profile_edit' %}" class="btn-edit-floating">
                        <i class="fa-solid fa-pen-to-square"></i> Editar Perfil
                    </a>
                </div>

                <!-- COLUMNA DERECHA: Detalles -->
                <div class="profile-details-card">
                    <h3 style="margin-top: 0; color: var(--secondary-color); border-bottom: 1px solid var(--border-light); padding-bottom: 1rem;">
                        Información Personal
                    </h3>

                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Usuario</span>
                            <span class="detail-value">@{{ user.username }}</span>
                        </div>

                        <div class="detail-item">
                            <span class="detail-label">Correo Electrónico</span>
                            <span class="detail-value">
                        <i class="fa-regular fa-envelope" style="color: var(--primary-color);"></i>
                        {{ user.email }}
                    </span>
                        </div>

                        <div class="detail-item">
                            <span class="detail-label">Número de Celular</span>
                            <span class="detail-value">
                        <i class="fa-solid fa-mobile-screen" style="color: var(--primary-color);"></i>
                        {{ persona.celular|default:"-- --" }}
                    </span>
                        </div>

                        <div class="detail-item">
                            <span class="detail-label">Fecha de Nacimiento</span>
                            <span class="detail-value">
                        <i class="fa-regular fa-calendar" style="color: var(--primary-color);"></i>
                        {{ persona.fecha_nacimiento|date:"d M, Y"|default:"No definida" }}
                    </span>
                        </div>

                        <div class="detail-item">
                            <span class="detail-label">Género</span>
                            <span class="detail-value">{{ persona.get_genero_display|default:"No especificado" }}</span>
                        </div>
                    </div>

                    <h3 style="margin-top: 2rem; color: var(--secondary-color); border-bottom: 1px solid var(--border-light); padding-bottom: 1rem;">
                        Ubicación
                    </h3>
                    <div class="details-grid">
                        <div class="detail-item" style="grid-column: 1 / -1;">
                            <span class="detail-label">Dirección</span>
                            <span class="detail-value">
                        <i class="fa-solid fa-map-pin" style="color: var(--primary-color);"></i>
                        {{ persona.direccion|default:"Dirección no registrada" }}
                    </span>
                        </div>
                    </div>
                </div>

            </div>
        {% else %}
            <!-- Fallback por si no existe perfil -->
            <div class="alert-box">
                No se encontró información de perfil. Por favor contacte soporte.
            </div>
        {% endif %}
    </div>
{% endblock %}