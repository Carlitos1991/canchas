{% extends "base.html" %}
{% load static %}

{% block title %}Iniciar Sesión o Registrarse{% endblock %}

{% block content %}
    <div id="auth-container" class="auth-container {% if show_signup %}right-panel-active{% endif %}"
         style="margin-top: 2rem;">

        <!-- =================================== -->
        <!-- 1. FORMULARIO DE REGISTRO (Sign Up) -->
        <!-- =================================== -->
        <div class="form-auth-container sign-up-container">
            <form method="post" novalidate>
                {% csrf_token %}
                <h2>Crear Cuenta</h2>

                <div class="social-icons">
                    <a href="#"><i class="fab fa-google"></i></a>
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-github"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
                <p class="social-login-divider">o usa tu email para registrarte</p>

                <!-- Errores Generales -->
                {% if user_form.non_field_errors %}
                    <div class="form-field">
                        <ul class="errorlist" style="position: relative; bottom: 0;">
                            {% for error in user_form.non_field_errors %}
                                <li>{{ error }}</li>{% endfor %}
                        </ul>
                    </div>
                {% endif %}

                <!-- Usuario -->
                <div class="form-field"> <!-- ESTE DIV DA EL ESPACIO -->
                    <div class="form-field-wrapper">
                        <i class="icon fas fa-user"></i>
                        {{ user_form.username }}
                    </div>
                    <!-- Errores específicos del campo -->
                    {% if user_form.username.errors %}
                        <ul class="errorlist">{% for error in user_form.username.errors %}
                            <li>{{ error }}</li>{% endfor %}</ul>
                    {% endif %}
                </div>

                <!-- Email -->
                <div class="form-field"> <!-- ESTE DIV DA EL ESPACIO -->
                    <div class="form-field-wrapper">
                        <i class="icon fas fa-envelope"></i>
                        {{ user_form.email }}
                    </div>
                    {% if user_form.email.errors %}
                        <ul class="errorlist">{% for error in user_form.email.errors %}
                            <li>{{ error }}</li>{% endfor %}</ul>
                    {% endif %}
                </div>

                <!-- Contraseña -->
                <div class="form-field"> <!-- ESTE DIV DA EL ESPACIO -->
                    <div class="form-field-wrapper">
                        <i class="icon fas fa-lock"></i>
                        {{ user_form.password }}
                        <i class="fas fa-eye password-toggle-icon"
                           id="toggle_reg_password"
                           onclick="togglePassword('reg_password', 'toggle_reg_password')"></i>
                    </div>
                    {% if user_form.password.errors %}
                        <ul class="errorlist">{% for error in user_form.password.errors %}
                            <li>{{ error }}</li>{% endfor %}</ul>
                    {% endif %}
                </div>

                <!-- Confirmar Contraseña -->
                <div class="form-field"> <!-- ESTE DIV DA EL ESPACIO -->
                    <div class="form-field-wrapper">
                        <i class="icon fas fa-check-double"></i>
                        {{ user_form.password_confirm }}
                        <i class="fas fa-eye password-toggle-icon"
                           id="toggle_reg_confirm"
                           onclick="togglePassword('reg_confirm', 'toggle_reg_confirm')"></i>
                    </div>
                    {% if user_form.password_confirm.errors %}
                        <ul class="errorlist">{% for error in user_form.password_confirm.errors %}
                            <li>{{ error }}</li>{% endfor %}</ul>
                    {% endif %}
                </div>

                <button type="submit" name="signup_submit" class="btn-primary">Registrarse</button>
            </form>
        </div>

        <!-- =================================== -->
        <!-- 2. FORMULARIO DE LOGIN (Sign In)    -->
        <!-- =================================== -->
        <div class="form-auth-container sign-in-container">
            <form method="post" novalidate>
                {% csrf_token %}
                <img src="{% static 'media/icono.png' %}" alt="Logo Canchas" class="auth-logo">
                <h2>Iniciar Sesión</h2>

                <div class="social-icons">
                    <a href="#"><i class="fab fa-google"></i></a>
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                </div>
                <p class="social-login-divider">o usa tu cuenta</p>

                <!-- Errores generales de login -->
                {% if login_form.non_field_errors %}
                    <ul class="errorlist">{% for error in login_form.non_field_errors %}
                        <li>{{ error }}</li>{% endfor %}</ul>
                {% endif %}

                <!-- Usuario Login -->
                <div class="form-field">
                    <div class="form-field-wrapper">
                        <i class="icon fas fa-user"></i>
                        {{ login_form.username }}
                    </div>
                    {{ login_form.username.errors }}
                </div>

                <!-- Contraseña Login (ID generado: login_password) -->
                <div class="form-field-wrapper">
                    <i class="icon fas fa-lock"></i>
                    {{ login_form.password }}
                    <!-- AGREGAMOS onclick DIRECTO -->
                    <i class="fas fa-eye password-toggle-icon"
                       id="toggle_login_password"
                       onclick="togglePassword('login_password', 'toggle_login_password')"></i>
                </div>

                <div class="forgot-password">
                    <a href="#">¿Olvidaste tu contraseña?</a>
                </div>

                <button type="submit" name="login_submit" class="btn-primary">Iniciar Sesión</button>
            </form>
        </div>

        <!-- =================================== -->
        <!-- 3. OVERLAY (Paneles)                -->
        <!-- =================================== -->
        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-panel overlay-left">
                    <img src="{% static 'media/icono.png' %}" alt="Logo Canchas" class="auth-logo">
                    <h2>¡Bienvenido de Nuevo!</h2>
                    <p>Para seguir conectado con nosotros, por favor inicia sesión con tu cuenta</p>
                    <button class="btn-secondary" id="signInButton">Iniciar Sesión</button>
                </div>
                <div class="overlay-panel overlay-right">
                    <h2>¡Hola, Amigo!</h2>
                    <p>Ingresa tus datos personales y comienza tus reservas</p>
                    <button class="btn-secondary" id="signUpButton">Registrarse</button>
                </div>
            </div>
        </div>
    </div>

    <script src="{% static 'js/auth.js' %}"></script>
{% endblock %}